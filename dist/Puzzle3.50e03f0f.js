parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=exports.BasePuzzle=function(){function n(e){t(this,n),this.setting=e.setting,this.locale=e.locale,this.state={answer:"",answerSent:!1}}return e(n,[{key:"onSubmit",value:function(){}},{key:"sendAnswer",value:function(e){window.alert(this.locale.general["str-answer-sent"]);var t=JSON.stringify({setting:this.setting,locale:this.locale,answer:this.state.answer});console.log("Complete answer:",t),this.setState({answerSent:!0},e)}},{key:"setup",value:function(){this.parentEl=document.querySelector("#puzzle"),this.renderHTML()}},{key:"renderInner",value:function(e,t){var n=this;t instanceof HTMLElement||t instanceof Text?e.appendChild(t):t instanceof Array?t.forEach(function(t){n.renderInner(e,t)}):e.innerText=t||""}},{key:"renderElement",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.parentEl,a=document.createElement(e);a.id=t,this.renderInner(a,n);var i=document.querySelector("#"+t);return i&&i.parentNode.removeChild(i),r&&r.appendChild(a),a}},{key:"renderHTML",value:function(){this.parentEl.innerHTML="",this.renderElement("h1","puzzleName",this.locale.specific["str-name"])}},{key:"setState",value:function(e,t){var n=this.state;this.state=Object.assign({},n,e),"function"==typeof t?t():this.updateView()}},{key:"updateView",value:function(){}}]),n}();
},{}],12:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=exports.Clip=function(){function s(t,n,a,i){e(this,s),this.type=t,this.mime=n,this.src=a,this.callbacks=i,this.playing=!1,this.expanded=!1}return t(s,[{key:"render",value:function(){this.container=document.createElement("div"),this.container.className="media-container",this.playButton=document.createElement("div"),this.playButton.className="play-pause-button",this.playButton.classList.add(this.playing?"pause":"play"),this.playButton.onclick=this.onPlayButtonPress.bind(this),this.progressBarContainer=document.createElement("div"),this.progressBarContainer.className="progress",this.progressBar=document.createElement("div"),this.progressBar.className="progressbar",this.progressBarContainer.appendChild(this.progressBar),this.media=document.createElement(this.type),this.media.src=this.src,this.media.type=this.mime,"video"===this.type&&(this.media.width=300,this.expandButton=document.createElement("div"),this.expandButton.className="expand-button",this.expandButton.classList.add("expand"),this.expandButton.onclick=this.onExpandButtonPress.bind(this)),this.processMedia(),this.processProgressBar();var t=document.createElement("div");return t.className="controls",t.appendChild(this.playButton),t.appendChild(this.progressBarContainer),this.expandButton&&t.appendChild(this.expandButton),this.container.appendChild(this.media),this.container.appendChild(t),this.container}},{key:"onPlayButtonPress",value:function(){this.playing?this.media.pause():this.media.play()}},{key:"onExpandButtonPress",value:function(){this.expanded?(this.container.classList.remove("expanded"),this.expandButton.classList.add("expand"),this.expandButton.classList.remove("contract"),this.expanded=!1,this.media.width=300):(this.container.classList.add("expanded"),this.expandButton.classList.remove("expand"),this.expandButton.classList.add("contract"),this.media.width=600,this.expanded=!0),window.dispatchEvent(new Event("resize"))}},{key:"processMedia",value:function(){var t=this,e=this.media;e.ontimeupdate=function(){var s=e.currentTime/e.duration*100;t.progressBar.style.width=s+"%",e.currentTime==e.duration&&(e.currentTimee=0,t.progressBar.style.width="0%",t.playButton.classList.remove("pause"),t.playButton.classList.add("play"))},e.onplay=function(){t.playing=!0,t.playButton.classList.add("pause"),t.playButton.classList.remove("play")},e.onpause=function(){t.playing=!1,t.playButton.classList.remove("pause"),t.playButton.classList.add("play")},e.oncanplay=function(e){"function"==typeof t.callbacks.oncanplay&&t.callbacks.oncanplay(e)}}},{key:"processProgressBar",value:function(){function t(t){var e=this.progressBarContainer.getBoundingClientRect();this.media.currentTime=this.media.duration*((t.clientX-e.left)/(e.right-e.left))}this.progressBarContainer.onclick=t.bind(this),this.progressBarContainer.ontouchstart=t.bind(this)}}]),s}();
},{}],11:[function(require,module,exports) {

},{"./../static/ajax-loader.gif":[["ajax-loader.e07342ab.gif",15],15],"./../static/play-icon.svg":[["play-icon.58d07d65.svg",18],18],"./../static/pause-icon.svg":[["pause-icon.ec0ae763.svg",16],16],"./../static/expand-icon.svg":[["expand-icon.1a2af0f7.svg",17],17],"./../static/contract-icon.svg":[["contract-icon.5427be8d.svg",19],19]}],7:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Puzzle3=void 0;var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),t=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},n=require("./BasePuzzle"),i=require("../lib/Clip");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}require("./Puzzle3.css");var o=exports.Puzzle3=function(i){function o(e){r(this,o);var t=s(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e));return t.state=Object.assign(t.state,{answerCheck:[],submitted:!1}),t.slots=t.setting.slots.map(function(e){return new l(e,{onChange:t.onAnswerChange.bind(t)})}),t.draggables=t.setting.draggables.map(function(e){return new u(e)}),t.setup(),t}return a(o,n.BasePuzzle),e(o,[{key:"setup",value:function(){var e=this;t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setup",this).call(this),window.onresize=function(){e.updateSlotPositions(e.backgroundImage)}}},{key:"cleanUp",value:function(){window.onresize=null}},{key:"onSubmit",value:function(){if(this.canSubmit()){var e=this.slots.map(function(e){return e.check()});this.setState({answerCheck:e,submitted:!0})}}},{key:"onSendAnswer",value:function(){this.canSend()&&this.sendAnswer()}},{key:"onAnswerChange",value:function(){if(this.canEditAnswer()){var e=this.slots.map(function(e){return{slot:e.id,draggable:e.draggable?e.draggable.id:null}});this.setState({answer:e})}}},{key:"canEditAnswer",value:function(){return!this.state.answerSent}},{key:"canSubmit",value:function(){var e=this.state,t=e.answer;return!e.submitted&&t.length>0}},{key:"canSend",value:function(){var e=this.state,t=e.answerSent;return e.submitted&&!t}},{key:"updateView",value:function(){t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"updateView",this).call(this),this.updateButtons()}},{key:"updateButtons",value:function(){this.submitButton.disabled=!this.canSubmit(),this.sendAnswerButton.disabled=!this.canSend()}},{key:"updateSlotPositions",value:function(e){var t=e.offsetWidth/e.naturalWidth,n=e.offsetHeight/e.naturalHeight;this.slots.forEach(function(e){return e.setPosition({widthRatio:t,heightRatio:n})})}},{key:"renderHTML",value:function(){t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"renderHTML",this).call(this);var e=this.renderElement("div","wrapper",null);this.renderElement("div","background",this.renderBackground(),e);var n=this.renderElement("div","draggables-container",this.renderDraggables(),e);n.ondragover=function(e){return e.preventDefault()},n.ondrop=function(e){e.preventDefault();var t=e.dataTransfer.getData("dragged-id");if(t){var i=document.getElementById(t);i.Draggable&&(i.Draggable.setSlot(null),n.appendChild(i))}},this.submitButton=this.renderElement("button","puzzleSubmit",this.locale.general["str-check-answer"]),this.submitButton.onclick=this.onSubmit.bind(this),this.submitButton.disabled=!0,this.sendAnswerButton=this.renderElement("button","puzzleSend",this.locale.general["str-send-answer"]),this.sendAnswerButton.onclick=this.onSendAnswer.bind(this),this.sendAnswerButton.disabled=!0,this.updateView()}},{key:"renderBackground",value:function(){var e=this,t=document.createElement("img");return t.src=this.setting.backgroundUrl,t.id="background-image",t.onload=function(){e.updateSlotPositions(t),e.slots.forEach(function(e){return t.parentNode.appendChild(e.el)})},this.backgroundImage=t,t}},{key:"renderDraggables",value:function(){return this.draggables.map(function(e){return e.render()})}}]),o}(),l=function(){function t(e,n){var i=e.id,s=e.correctDraggable,a=e.top,o=e.left,l=n.onChange;r(this,t),this.id=i,this.correctDraggable=s,this.position={top:a,left:o},this.size=20,this.onDraggableChange=l,this.draggable=null,this.el=document.createElement("div"),this.el.className="slot",this.el.style.width=this.size+"px",this.el.style.height=this.size+"px",this.el.ondragover=this.onDragover.bind(this),this.el.ondrop=this.onDrop.bind(this),this.el.ondragenter=this.onDragEnter.bind(this),this.el.ondragleave=this.onDragLeave.bind(this)}return e(t,[{key:"check",value:function(){return!this.correctDraggable||!!this.draggable&&this.correctDraggable===this.draggable.id}},{key:"setDraggable",value:function(e){this.draggable=e,this.onDraggableChange()}},{key:"setPosition",value:function(e){var t=e.widthRatio,n=void 0===t?1:t,i=e.heightRatio,r=void 0===i?1:i;this.el.style.top=n*this.position.top-this.size/2+"px",this.el.style.left=r*this.position.left-this.size/2+"px"}},{key:"render",value:function(e){return this.setPosition(e),this.el}},{key:"onDragover",value:function(e){e.preventDefault()}},{key:"onDrop",value:function(e){e.preventDefault(),this.el.classList.remove("drag-hover");var t=e.dataTransfer.getData("dragged-id");if(t){var n=document.getElementById(t);n.Draggable&&(this.draggable?this.draggable.swap(n.Draggable):(n.Draggable.setSlot(this),this.el.appendChild(n)))}}},{key:"onDragEnter",value:function(){this.el.classList.add("drag-hover")}},{key:"onDragLeave",value:function(){this.el.classList.remove("drag-hover")}}]),t}(),u=function(){function t(e){var n=e.id,i=e.type,s=e.content;r(this,t),this.id=n,this.type=i,this.content=s,this.slot=null,this.el=this.renderElement(),this.el.ondragstart=this.onDragStart.bind(this),this.el.ondragend=this.onDragEnd.bind(this),this.el.Draggable=this}return e(t,[{key:"render",value:function(){return this.el}},{key:"renderElement",value:function(){var e=document.createElement("div");return e.id="draggable-"+this.id,e.className="draggable",e.draggable=!0,e.ondragstart=this.onDragStart.bind(this),e.ondragend=this.onDragEnd.bind(this),e.appendChild(this.renderContent(e)),e}},{key:"renderContent",value:function(e){switch(this.type.split("/")[0]){case"text":return this.renderTextContent(e);case"image":return this.renderImageContent(e);case"audio":return this.renderAudioContent(e);case"video":return this.renderVideoContent(e);default:return document.createTextNode("N/A")}}},{key:"renderImageContent",value:function(e){e.classList.add("loading");var t=document.createElement("img");return t.src=this.content,t.onload=function(){window.dispatchEvent(new Event("resize")),e.classList.remove("loading")},t}},{key:"renderAudioContent",value:function(e){return e.classList.add("loading"),new i.Clip("audio",this.type,this.content,{oncanplay:function(){window.dispatchEvent(new Event("resize")),e.classList.remove("loading")}}).render()}},{key:"renderVideoContent",value:function(e){return e.classList.add("loading"),new i.Clip("video",this.type,this.content,{oncanplay:function(){window.dispatchEvent(new Event("resize")),e.classList.remove("loading")}}).render()}},{key:"renderTextContent",value:function(e){e.style.minWidth="100px",e.style.padding="4px";var t=document.createElement("p");return t.innerText=this.content,t}},{key:"setSlot",value:function(e){this.slot&&this.slot.setDraggable(null),e?(e.setDraggable(this),this.el.classList.add("in-slot")):this.el.classList.remove("in-slot"),this.slot=e}},{key:"onDragStart",value:function(e){var t=this;e.dataTransfer.setData("dragged-id",this.el.id),this.el.classList.add("dragging"),setTimeout(function(){t.el.classList.add("hide")},1)}},{key:"onDragEnd",value:function(){this.el.classList.remove("dragging"),this.el.classList.remove("hide"),window.dispatchEvent(new Event("resize"))}},{key:"swap",value:function(e){if(e instanceof t){var n=e.el.parentNode,i=e.slot,r=this.el.parentNode,s=this.slot;this.setSlot(i),n.appendChild(this.el),e.setSlot(s),r.appendChild(e.el)}}}]),t}();window.Puzzle3=o;
},{"./BasePuzzle":9,"../lib/Clip":12,"./Puzzle3.css":11}]},{},[7])
//# sourceMappingURL=/Puzzle3.8952a837.map