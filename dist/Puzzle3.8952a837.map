{"version":3,"sources":["puzzles/BasePuzzle.js","lib/Clip.js","puzzles/Puzzle3.js"],"names":["BasePuzzle","data","setting","locale","state","answer","answerSent","callback","window","alert","general","completeAnswer","JSON","stringify","console","log","setState","parentEl","document","querySelector","renderHTML","el","inner","HTMLElement","Text","appendChild","Array","forEach","renderInner","i","innerText","type","id","parent","newEl","createElement","oldEl","parentNode","removeChild","innerHTML","renderElement","specific","newState","oldState","Object","assign","updateView","Clip","mime","src","callbacks","playing","expanded","container","className","playButton","classList","add","onclick","onPlayButtonPress","bind","progressBarContainer","progressBar","media","width","expandButton","onExpandButtonPress","processMedia","processProgressBar","controlWrapper","pause","play","remove","dispatchEvent","Event","ontimeupdate","progress","currentTime","duration","style","currentTimee","onplay","onpause","oncanplay","event","processClickTouch","ontouchstart","rect","getBoundingClientRect","clientX","left","right","Puzzle3","answerCheck","submitted","slots","map","Slot","s","onChange","onAnswerChange","draggables","Draggable","d","setup","onresize","updateSlotPositions","backgroundImage","canSubmit","check","canSend","sendAnswer","canEditAnswer","slot","draggable","length","updateButtons","submitButton","disabled","sendAnswerButton","imageEl","widthRatio","offsetWidth","naturalWidth","heightRatio","offsetHeight","naturalHeight","setPosition","wrapper","renderBackground","draggabblesContainer","renderDraggables","ondragover","preventDefault","ondrop","dataTransfer","getData","getElementById","setSlot","onSubmit","onSendAnswer","backgroundUrl","onload","render","correctDraggable","top","position","size","onDraggableChange","height","onDragover","onDrop","ondragenter","onDragEnter","ondragleave","onDragLeave","newDraggable","ratios","swap","content","ondragstart","onDragStart","ondragend","onDragEnd","renderContent","split","renderTextContent","renderImageContent","renderAudioContent","renderVideoContent","createTextNode","audio","video","minWidth","padding","newSlot","setDraggable","setData","setTimeout","other","otherParent","otherSlot","thisParent","thisSlot"],"mappings":"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SAAvB,CAAhB;ACGA,ADFA,WCEKgD,ADFA/C,UAAL,ECEA;AACA,ADFD,AEbC,UAAKoF,CDeApC,ICfL,cDeA;AChCgB;ADkChB,AChBD,UDgBOC,iBAAiBnD,SAASiB,aAAT,CAAuB,KAAvB,CAAvB;AACAkC,qBAAef,SAAf,EDHUjC,CCGiB,GDHbC,OCGd,ADHqB;ACIrB+C,ADJqB,qBCIN5C,WAAf,CAA2B,KAAK8B,UAAhC;AACAc,qBAAe5C,WAAf,CAA2B,KAAKoC,oBAAhC;AACA,ADLA,UCKI,ADLAvC,KCKK2C,YAAT,ADLqB1C,CEbf,CDkBiB8C,SDLnB,IAAgC/C,ECKEG,WAAf,CAA2B,GDLGD,ECKEyC,EDLvD,EAA2D,QCKpC;ADJrB5C,AEdI,WFcDI,WAAH,CAAeH,KAAf;ACMF,ADLC,OAFD,ICOK+B,EDLE,IAAI/B,GCKX,CAAeG,WAAf,CAA2B,CDLCC,ICKIqC,CDLzB,EAA4B,ECKnC;AACA,ADLEzC,AEfF,WDoBK+B,GDLG1B,MCKR,CAAeF,ADLb,CAAc,UCKhB,CAA2B4C,EDLN,YCKrB;ADJI,AEfJ7D,aAAOiG,GFeE7E,KEfT,GAAkB,GFed,CAAiBP,EAAjB,EAAqBQ,CAArB,GEfoB;ADqBxB,ADLG,AEfD,SFaA,ICOK,ECpBA6E,GDoBKrD,SAAZ,OCpBE,CAAyB,OAAKsD,eAA9B;ADqBH,ADLE,AEfA,OFWM,AEbP,MFiBO;AACLtF,AEfH,WFeMS,SAAH,GAAeR,SAAS,EAAxB;AACD;AACF,wCCImB;AAClB,UAAI,KAAK6B,OAAT,EAAkB,KAAKY,CCpBf,IDoBU,CAAWO,KAAX,GAAlB,KACK,KAAKP,KAAL,CAAWQ,IAAX;AACN,ACrBC/D,aAAOiG,QAAP,GAAkB,IAAlB;AACD,kCFea1E,MAAMC,IAAIV,OAA+B;AAAA,UAAxBW,MAAwB,uEAAf,KAAKhB,QAAU;0CCOjC;AACpB,ADPA,UCOI,ADPEiB,KCOGkB,GDPKlC,KCOd,EAAmB,EDPIiB,IEdd,SFcK,CAAuBJ,IAAvB,CAAd;ACQE,ADPFG,AEdA,UAAI,CAAC,CFcCF,CCOCqB,CDPP,EEdUuD,CFcC5E,EAAX,GCOE,CAAewB,ECrBZ,EAAL,EAAuB,GDqBrB,CAAyBgB,MAAzB,CAAgC,UAAhC;AACA,ACrBF,UAAMqB,GDqBC5B,WCrBa,CDqBlB,CAAkBT,GCrBKuC,KAAL,CDqBlB,ACrB6BC,CDqBDvC,ECrBV,CDqBlB,ACrBiC,CDqBD,QAAhC;AACA,ADPF,AEfmC,WFe9B7B,ECOEqC,ECtBiCiC,EAAEW,KFe1C,AEfwC,CFevB3E,CEfkB,CDsBjC,CAAkBsB,EDPpB,EAAwBlC,KCOtB,ADPF,CCO8BkD,MAA5B,CAAmC,UAAnC;AACA,ACvBiC,OAAf,CAApB,KDuBOpB,QAAL,GAAgB,KAAhB;AACA,ADPF,AEhBA,UFgBMhB,CEhBDpB,EDuBE+C,KAAL,ADPY7C,CCOD8C,ACvBb,CAAc,EAAE6B,EDuBd,GAAmB,ADPE1E,GCOrB,UDPY,MEhBA,CFgB2Ba,CEhBZ8D,CFgBf,CAAd,SEhBwC,IAA1B,EAAd;ADwBC,ADPD,AEhBD,ODiBC,GDDI1D,GCOG,EDPP,EAAWA,MAAMC,UAAN,CAAiBC,WAAjB,CAA6BF,KAA7B;ACQT,aAAKiB,SAAL,CAAeG,SAAf,CAAyBC,GAAzB,CAA6B,UAA7B;AACA,ADPF,UAAIxB,GCOGgC,GDPP,EAAY,OCOV,CAAkBT,SAAlB,CAA4BgB,MAA5B,CAAmC,QAAnC;AACA,ADPAvC,aCOKgC,EDPExC,UCOP,CAAkB+B,ADPlB,CAAmBtB,KAAnB,GCOA,ACxBW,CDwBiBuB,GAA5B,CAAgC,UAAhC;AACA,ADPD,AEjBD,UAAI,CAAC,EDwBEM,GCxBG+C,EDwBR,CAAW9C,ICxBR,CDwBH,CCxBF,EDwBqB,ACxBA,GDwBnB;AACA,ACxBF,WAAK+C,EDwBE3D,QAAL,ACxBF,GDwBkB,IAAhB;AACD,ADPD,AEjBD,aFiBQlB,KAAP;AACD;ACQC;AACA1B,aAAOiE,aAAP,CAAqB,IAAIC,KAAJ,CAAU,ACzBhB,QDyBM,CAArB;AACD,ACzBC,UAAI,CAAC,KAAKsC,aAAL,EAAL,EFiBW,AEjBgB;AFkB3B,AEjBA,UAAM3G,CFiBDY,QAAL,AEjBe,CFiBDsB,IEjBMwD,KFiBpB,AEjBe,CAAWC,EFiBA,CEjBX,CFiBf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","file":"Puzzle3.8952a837.map","sourceRoot":"../src","sourcesContent":["export class BasePuzzle {\n  /**\n   * @param {object} data\n   */\n\n  constructor(data) {\n    this.setting = data.setting;\n    this.locale = data.locale;\n\n    this.state = {\n      answer: \"\",\n      answerSent: false\n    };\n  }\n\n  onSubmit() {}\n\n  sendAnswer(callback) {\n    window.alert(this.locale.general[\"str-answer-sent\"]);\n\n    // TODO: Actually send \"completeAnswer\" to server\n    const completeAnswer = JSON.stringify({\n      setting: this.setting,\n      locale: this.locale,\n      answer: this.state.answer\n    });\n\n    // eslint-disable-next-line no-console\n    console.log(\"Complete answer:\", completeAnswer);\n\n    this.setState({ answerSent: true }, callback);\n  }\n\n  setup() {\n    this.parentEl = document.querySelector(\"#puzzle\");\n    this.renderHTML();\n  }\n\n  renderInner(el, inner) {\n    if (inner instanceof HTMLElement || inner instanceof Text) {\n      el.appendChild(inner);\n    } else if (inner instanceof Array) {\n      inner.forEach(i => {\n        this.renderInner(el, i);\n      });\n    } else {\n      el.innerText = inner || \"\";\n    }\n  }\n\n  renderElement(type, id, inner, parent = this.parentEl) {\n    const newEl = document.createElement(type);\n    newEl.id = id;\n\n    this.renderInner(newEl, inner);\n\n    const oldEl = document.querySelector(`#${id}`);\n    if (oldEl) oldEl.parentNode.removeChild(oldEl);\n\n    if (parent) {\n      parent.appendChild(newEl);\n    }\n\n    return newEl;\n  }\n\n  renderHTML() {\n    this.parentEl.innerHTML = \"\";\n    this.renderElement(\"h1\", \"puzzleName\", this.locale.specific[\"str-name\"]);\n  }\n\n  setState(newState, callback) {\n    const oldState = this.state;\n    this.state = Object.assign({}, oldState, newState);\n    if (typeof callback === \"function\") callback();\n    else this.updateView();\n  }\n\n  updateView() {}\n}\n","export class Clip {\n  constructor(type, mime, src, callbacks) {\n    this.type = type;\n    this.mime = mime;\n    this.src = src;\n    this.callbacks = callbacks;\n    this.playing = false;\n    this.expanded = false;\n  }\n\n  render() {\n    this.container = document.createElement(\"div\");\n    this.container.className = \"media-container\";\n\n    this.playButton = document.createElement(\"div\");\n    this.playButton.className = \"play-pause-button\";\n    this.playButton.classList.add(this.playing ? \"pause\" : \"play\");\n    this.playButton.onclick = this.onPlayButtonPress.bind(this);\n\n    this.progressBarContainer = document.createElement(\"div\");\n    this.progressBarContainer.className = \"progress\";\n    this.progressBar = document.createElement(\"div\");\n    this.progressBar.className = \"progressbar\";\n    this.progressBarContainer.appendChild(this.progressBar);\n\n    this.media = document.createElement(this.type);\n    this.media.src = this.src;\n    this.media.type = this.mime;\n\n    if (this.type === \"video\") {\n      this.media.width = 300;\n      this.expandButton = document.createElement(\"div\");\n      this.expandButton.className = \"expand-button\";\n      this.expandButton.classList.add(\"expand\");\n      this.expandButton.onclick = this.onExpandButtonPress.bind(this);\n    }\n\n    this.processMedia();\n    this.processProgressBar();\n\n    const controlWrapper = document.createElement(\"div\");\n    controlWrapper.className = \"controls\";\n    controlWrapper.appendChild(this.playButton);\n    controlWrapper.appendChild(this.progressBarContainer);\n    if (this.expandButton) controlWrapper.appendChild(this.expandButton);\n\n    this.container.appendChild(this.media);\n    this.container.appendChild(controlWrapper);\n\n    return this.container;\n  }\n\n  onPlayButtonPress() {\n    if (this.playing) this.media.pause();\n    else this.media.play();\n  }\n\n  onExpandButtonPress() {\n    if (this.expanded) {\n      this.container.classList.remove(\"expanded\");\n      this.expandButton.classList.add(\"expand\");\n      this.expandButton.classList.remove(\"contract\");\n      this.expanded = false;\n      this.media.width = 300;\n    } else {\n      this.container.classList.add(\"expanded\");\n      this.expandButton.classList.remove(\"expand\");\n      this.expandButton.classList.add(\"contract\");\n      this.media.width = 600;\n      this.expanded = true;\n    }\n\n    // To force recalculation of the positions of the slotsS\n    window.dispatchEvent(new Event(\"resize\"));\n  }\n\n  processMedia() {\n    const { media } = this;\n\n    media.ontimeupdate = () => {\n      const progress = media.currentTime / media.duration * 100;\n      this.progressBar.style.width = progress + \"%\";\n      if (media.currentTime == media.duration) {\n        media.currentTimee = 0;\n        this.progressBar.style.width = \"0%\";\n        this.playButton.classList.remove(\"pause\");\n        this.playButton.classList.add(\"play\");\n      }\n    };\n\n    media.onplay = () => {\n      this.playing = true;\n      this.playButton.classList.add(\"pause\");\n      this.playButton.classList.remove(\"play\");\n    };\n\n    media.onpause = () => {\n      this.playing = false;\n      this.playButton.classList.remove(\"pause\");\n      this.playButton.classList.add(\"play\");\n    };\n\n    media.oncanplay = event => {\n      if (typeof this.callbacks.oncanplay === \"function\") {\n        this.callbacks.oncanplay(event);\n      }\n    };\n  }\n\n  processProgressBar() {\n    this.progressBarContainer.onclick = processClickTouch.bind(this);\n    this.progressBarContainer.ontouchstart = processClickTouch.bind(this);\n\n    function processClickTouch(event) {\n      const rect = this.progressBarContainer.getBoundingClientRect();\n\n      this.media.currentTime =\n        this.media.duration *\n        ((event.clientX - rect.left) / (rect.right - rect.left));\n    }\n  }\n}\n","import { BasePuzzle } from \"./BasePuzzle\";\nimport { Clip } from \"../lib/Clip\";\n\nimport \"./Puzzle3.css\";\n\nexport class Puzzle3 extends BasePuzzle {\n  constructor(data) {\n    /**\n     * @param {object} data\n     */\n    super(data);\n\n    this.state = Object.assign(this.state, {\n      answerCheck: [],\n      submitted: false\n    });\n\n    this.slots = this.setting.slots.map(\n      s => new Slot(s, { onChange: this.onAnswerChange.bind(this) })\n    );\n\n    this.draggables = this.setting.draggables.map(d => new Draggable(d));\n\n    this.setup();\n  }\n\n  setup() {\n    super.setup();\n    window.onresize = () => {\n      this.updateSlotPositions(this.backgroundImage);\n    };\n  }\n\n  cleanUp() {\n    window.onresize = null;\n  }\n\n  onSubmit() {\n    if (!this.canSubmit()) return;\n    const answerCheck = this.slots.map(s => s.check());\n    this.setState({ answerCheck, submitted: true });\n  }\n\n  onSendAnswer() {\n    if (!this.canSend()) return;\n    this.sendAnswer();\n  }\n\n  onAnswerChange() {\n    if (!this.canEditAnswer()) return;\n    const answer = this.slots.map(s => ({\n      slot: s.id,\n      draggable: s.draggable ? s.draggable.id : null\n    }));\n    this.setState({ answer });\n  }\n\n  canEditAnswer() {\n    const { answerSent } = this.state;\n    return !answerSent;\n  }\n\n  canSubmit() {\n    const { answer, submitted } = this.state;\n    return !submitted && answer.length > 0;\n  }\n\n  canSend() {\n    const { answerSent, submitted } = this.state;\n    return submitted && !answerSent;\n  }\n\n  updateView() {\n    super.updateView();\n\n    this.updateButtons();\n  }\n\n  updateButtons() {\n    this.submitButton.disabled = !this.canSubmit();\n    this.sendAnswerButton.disabled = !this.canSend();\n  }\n\n  updateSlotPositions(imageEl) {\n    const widthRatio = imageEl.offsetWidth / imageEl.naturalWidth;\n    const heightRatio = imageEl.offsetHeight / imageEl.naturalHeight;\n    this.slots.forEach(s => s.setPosition({ widthRatio, heightRatio }));\n  }\n\n  renderHTML() {\n    super.renderHTML();\n\n    const wrapper = this.renderElement(\"div\", \"wrapper\", null);\n\n    this.renderElement(\"div\", \"background\", this.renderBackground(), wrapper);\n\n    const draggabblesContainer = this.renderElement(\n      \"div\",\n      \"draggables-container\",\n      this.renderDraggables(),\n      wrapper\n    );\n\n    draggabblesContainer.ondragover = event => event.preventDefault();\n    draggabblesContainer.ondrop = event => {\n      event.preventDefault();\n      const id = event.dataTransfer.getData(\"dragged-id\");\n      if (!id) return;\n      const el = document.getElementById(id);\n      if (!el.Draggable) return;\n      el.Draggable.setSlot(null);\n      draggabblesContainer.appendChild(el);\n    };\n\n    // Render \"Tarkista\"-button\n    this.submitButton = this.renderElement(\n      \"button\",\n      \"puzzleSubmit\",\n      this.locale.general[\"str-check-answer\"]\n    );\n    this.submitButton.onclick = this.onSubmit.bind(this);\n    this.submitButton.disabled = true;\n\n    // Render \"Lähetä\"-button\n    this.sendAnswerButton = this.renderElement(\n      \"button\",\n      \"puzzleSend\",\n      this.locale.general[\"str-send-answer\"]\n    );\n    this.sendAnswerButton.onclick = this.onSendAnswer.bind(this);\n    this.sendAnswerButton.disabled = true;\n\n    this.updateView();\n  }\n\n  renderBackground() {\n    const el = document.createElement(\"img\");\n    el.src = this.setting.backgroundUrl;\n    el.id = \"background-image\";\n    el.onload = () => {\n      this.updateSlotPositions(el);\n      this.slots.forEach(s => el.parentNode.appendChild(s.el));\n    };\n    this.backgroundImage = el;\n    return el;\n  }\n\n  renderDraggables() {\n    return this.draggables.map(d => d.render());\n  }\n}\n\nclass Slot {\n  constructor({ id, correctDraggable, top, left }, { onChange }) {\n    this.id = id;\n    this.correctDraggable = correctDraggable;\n    this.position = { top, left };\n    this.size = 20;\n\n    this.onDraggableChange = onChange;\n\n    this.draggable = null;\n\n    this.el = document.createElement(\"div\");\n    this.el.className = \"slot\";\n    this.el.style.width = this.size + \"px\";\n    this.el.style.height = this.size + \"px\";\n\n    this.el.ondragover = this.onDragover.bind(this);\n    this.el.ondrop = this.onDrop.bind(this);\n    this.el.ondragenter = this.onDragEnter.bind(this);\n    this.el.ondragleave = this.onDragLeave.bind(this);\n  }\n\n  check() {\n    return (\n      !this.correctDraggable ||\n      (!!this.draggable && this.correctDraggable === this.draggable.id)\n    );\n  }\n\n  setDraggable(newDraggable) {\n    this.draggable = newDraggable;\n    this.onDraggableChange();\n  }\n\n  setPosition({ widthRatio = 1, heightRatio = 1 }) {\n    this.el.style.top = widthRatio * this.position.top - this.size / 2 + \"px\";\n    this.el.style.left =\n      heightRatio * this.position.left - this.size / 2 + \"px\";\n  }\n\n  render(ratios) {\n    this.setPosition(ratios);\n    return this.el;\n  }\n\n  onDragover(event) {\n    event.preventDefault();\n  }\n\n  onDrop(event) {\n    event.preventDefault();\n    this.el.classList.remove(\"drag-hover\");\n    const id = event.dataTransfer.getData(\"dragged-id\");\n    if (!id) return;\n    const el = document.getElementById(id);\n    if (!el.Draggable) return; // Dragging something else than a Draggable\n    if (this.draggable) {\n      // Already occupied\n      this.draggable.swap(el.Draggable);\n    } else {\n      el.Draggable.setSlot(this);\n      this.el.appendChild(el);\n    }\n  }\n\n  onDragEnter() {\n    this.el.classList.add(\"drag-hover\");\n  }\n\n  onDragLeave() {\n    this.el.classList.remove(\"drag-hover\");\n  }\n}\n\nclass Draggable {\n  constructor({ id, type, content }) {\n    this.id = id;\n    this.type = type;\n    this.content = content;\n\n    this.slot = null;\n\n    this.el = this.renderElement();\n\n    // this.el.draggable = true;\n\n    this.el.ondragstart = this.onDragStart.bind(this);\n    this.el.ondragend = this.onDragEnd.bind(this);\n\n    this.el.Draggable = this;\n  }\n\n  render() {\n    return this.el;\n  }\n\n  renderElement() {\n    const el = document.createElement(\"div\");\n    el.id = `draggable-${this.id}`;\n    el.className = \"draggable\";\n\n    el.draggable = true;\n    el.ondragstart = this.onDragStart.bind(this);\n    el.ondragend = this.onDragEnd.bind(this);\n\n    el.appendChild(this.renderContent(el));\n\n    return el;\n  }\n\n  renderContent(parentEl) {\n    switch (this.type.split(\"/\")[0]) {\n      case \"text\":\n        return this.renderTextContent(parentEl);\n      case \"image\":\n        return this.renderImageContent(parentEl);\n      case \"audio\":\n        return this.renderAudioContent(parentEl);\n      case \"video\":\n        return this.renderVideoContent(parentEl);\n      default:\n        return document.createTextNode(\"N/A\");\n    }\n  }\n\n  renderImageContent(parentEl) {\n    parentEl.classList.add(\"loading\");\n    const el = document.createElement(\"img\");\n    el.src = this.content;\n    el.onload = () => {\n      // To force recalculation of the positions of the slotsS\n      window.dispatchEvent(new Event(\"resize\"));\n\n      parentEl.classList.remove(\"loading\");\n    };\n    return el;\n  }\n\n  renderAudioContent(parentEl) {\n    parentEl.classList.add(\"loading\");\n\n    const audio = new Clip(\"audio\", this.type, this.content, {\n      oncanplay: () => {\n        // To force recalculation of the positions of the slotsS\n        window.dispatchEvent(new Event(\"resize\"));\n\n        parentEl.classList.remove(\"loading\");\n      }\n    });\n\n    const el = audio.render();\n\n    return el;\n  }\n\n  /*\n   * Only direct URL to a video file is supported.\n   * Youtube and Vimeo for example require the use of iframe to play content.\n   * This can be circumvented by using a paid account. \n   * So they are not supported.\n   */\n  renderVideoContent(parentEl) {\n    parentEl.classList.add(\"loading\");\n\n    const video = new Clip(\"video\", this.type, this.content, {\n      oncanplay: () => {\n        // To force recalculation of the positions of the slotsS\n        window.dispatchEvent(new Event(\"resize\"));\n\n        parentEl.classList.remove(\"loading\");\n      }\n    });\n\n    const el = video.render();\n\n    return el;\n  }\n\n  renderTextContent(parentEl) {\n    parentEl.style.minWidth = 100 + \"px\";\n    parentEl.style.padding = 4 + \"px\";\n    const el = document.createElement(\"p\");\n    el.innerText = this.content;\n    return el;\n  }\n\n  setSlot(newSlot) {\n    if (this.slot) {\n      // Moving out of this.slot\n      this.slot.setDraggable(null);\n    }\n\n    if (newSlot) {\n      // Moving into newSlot\n      newSlot.setDraggable(this);\n      this.el.classList.add(\"in-slot\");\n    } else {\n      // newSlot is null so we are not in a Slot\n      this.el.classList.remove(\"in-slot\");\n    }\n\n    this.slot = newSlot;\n  }\n\n  onDragStart(event) {\n    event.dataTransfer.setData(\"dragged-id\", this.el.id);\n\n    this.el.classList.add(\"dragging\");\n\n    setTimeout(() => {\n      // Needs to be in a timeout because otherwise element we are dragging\n      // will be hidden as well\n      this.el.classList.add(\"hide\");\n    }, 1);\n  }\n\n  onDragEnd() {\n    this.el.classList.remove(\"dragging\");\n    this.el.classList.remove(\"hide\");\n\n    // To force recalculation of the positions of the slotsS\n    window.dispatchEvent(new Event(\"resize\"));\n  }\n\n  /*\n   * Swap places with other Draggable\n   */\n  swap(other) {\n    if (!(other instanceof Draggable)) return;\n    const otherParent = other.el.parentNode;\n    const otherSlot = other.slot;\n    const thisParent = this.el.parentNode;\n    const thisSlot = this.slot;\n\n    this.setSlot(otherSlot);\n    otherParent.appendChild(this.el);\n    other.setSlot(thisSlot);\n    thisParent.appendChild(other.el);\n  }\n}\n\nwindow.Puzzle3 = Puzzle3;\n"]}